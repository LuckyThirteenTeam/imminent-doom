<html>
	<head>
		<title>Imminent Doom</title>
		<link rel="stylesheet" href="./static/index.css" type="text/css">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
		<script src="https://kit.fontawesome.com/5a5c6dd537.js" crossorigin="anonymous"></script>
	</head>
	<body>
		<div id="vue-app">
			<!-- Map -->
			<div id="map">
			</div>
			<component :is="'script'"
				src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBK8yskeJGABTnzoT6Q8AVcoGuzwQ9v6nQ&callback=initMap&v=weekly"
				defer
			></component>

			<!-- Query panel -->
			<div class="panel">
				<div class="panel-buttons">
					<button @click="panelState = 0" class="button" v-bind:class="{ active: panelState === 0 }">
						<i class="fa fa-xl fa-solid fa-location-arrow"></i>
						Location
					</button>
					<button @click="panelState = 1" class="button" v-bind:class="{ active: panelState === 1 }">
						<i class="fa fa-xl fa-solid fa-thermometer"></i>
						Hot/Cold
					</button>
					<button @click="panelState = 2" class="button" v-bind:class="{ active: panelState === 2, 'temp-disabled': true }">
						<i class="fa fa-xl fa-solid fa-arrow-down-up-across-line"></i>
						Anomalies
					</button>
					<button @click="panelState = 3" class="button" v-bind:class="{ active: panelState === 3, 'temp-disabled': true }">
						<i class="fa fa-xl fa-user"></i>
						Account
					</button>
				</div>
				<div>
					<div class="panel-input-container" v-if="panelState === 0">
						Enter a location to view nearby weather stations with historical climate data
						<div class="panel-input-boxes">
							<input class="panel-input input-location" type="text" v-model="userLocation">
							<button class="panel-input-button" @click="getNearbyStationsQuery()">
								<i class="fa-xl fa-solid fa-magnifying-glass"></i>
							</button>
						</div>
					</div>
					<div class="panel-input-container" v-if="panelState === 1">
						Enter a date and the number of locations to view the hottest/coldest locations on that date
						<div class="panel-input-boxes">
							<input class="panel-input" type="date" min="2000-01-02" max="2022-10-16" v-model="inHCLDate">
							<input class="panel-input input-num" type="number" min="5" max="100" v-model="inHCLCount">
							<button class="panel-input-button" @click="getHotAndColdLocations(inHCLDate, inHCLCount)">
								<i class="fa-xl fa-solid fa-magnifying-glass"></i>
							</button>
						</div>
					</div>
					<div class="panel-input-container" v-if="panelState === 2">
						Enter a date and the number of locations to view the locations with temperatures furthest from their all-time average temperature on that date
						<div class="panel-input-boxes">
							<input class="panel-input" type="date" v-model="inHCLDate">
							<input class="panel-input input-num" type="number" v-model="inHCLCount">
							<button class="panel-input-button" @click="getHotAndColdLocations(inHCLDate, inHCLCount)">
								<i class="fa-xl fa-solid fa-magnifying-glass"></i>
							</button>
						</div>
					</div>
					<div class="panel-input-container" v-if="panelState === 3">
						Manage saved weather stations
					</div>
				</div>
			</div>
				
			<!-- Info panel -->
			<div class="panel bottom-panel" v-if="outputPanelState !== -1">
				<!-- Nearby Stations -->
				<div v-if="outputPanelState === 0">
					<div class="no-results" v-if="error || nearbyStations.length === 0">
						<i class="fa-2x fa-solid fa-file-circle-exclamation"></i>
						No nearby stations found, please try another location.
					</div>
					<div v-if="nearbyStations.length !== 0">
						<div class="header">
							<i class="fa-solid fa-warehouse"></i>
							Nearby Stations ({{ nearbyStations.length }})
						</div>
						<table>
							<thead>
								<tr>
									<td>Station</td>
									<td>Latitude</td>
									<td>Longitude</td>
								</tr>
							</thead>
							<tbody>
								<tr class="nearby-station" @click="goToStation(row[1], row[2])" v-for="(row, index) in nearbyStations">
									<td v-for="data in row">{{ data }}</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>

				<!-- Station Info -->
				<div v-if="outputPanelState === 1 && stationInfo.length !== 0">
					<div class="station-info">
						Station {{ stationInfo[stationIndex][0] }}: {{ stationInfo[stationIndex][10] }}, {{ stationInfo[stationIndex][11] }}
					</div>
					<div class="country">
						<i class="fa-solid fa-earth-americas"></i>
						{{ stationInfo[stationIndex][9] }}
					</div>
					
					<div class="station-info-header">
						<i class="fa-regular fa-calendar"></i>
						Date ({{ stationInfo[stationIndex][1] }})
						<input class="date-slider" v-model="stationIndex" type="range" step="1" min="0" :max="stationInfo.length - 1">
					</div>

					<div class="station-info-header">
						<i class="fa-solid fa-temperature-full"></i>
						Temperature (°F)
					</div>
					<table>
						<thead>
							<tr>
								<td>Average</td>
								<td>Minimum</td>
								<td>Maximum</td>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>{{ stationInfo[stationIndex][2] }}</td>
								<td>{{ stationInfo[stationIndex][7] }}</td>
								<td>{{ stationInfo[stationIndex][8] }}</td>
							</tr>
						</tbody>
					</table>

					<div class="station-info-header">
						<i class="fa-solid fa-cloud"></i>
						Climate
					</div>
					<table>
						<thead>
							<tr>
								<td>
									Pressure <br />
									(.1 mb)
								</td>
								<td>
									Visibility <br />
									(.1 miles)
								</td>
								<td>
									Wind Speed <br />
									(.1 knots)
								</td>
								<td>
									Precipitation <br />
									(.01 inches)
								</td>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>{{ stationInfo[stationIndex][3] }}</td>
								<td>{{ stationInfo[stationIndex][5] }}</td>
								<td>{{ stationInfo[stationIndex][6] }}</td>
								<td>{{ stationInfo[stationIndex][4] }}</td>
							</tr>
						</tbody>
					</table>

					<br />
					<button class="save-station" v-bind:class="{ saved: true }">
						<div v-if="true">
							<i class="fa-solid fa-bookmark"></i>
							Saved
						</div>
						<div v-if="false">
							<i class="fa-regular fa-bookmark"></i>
							Save
						</div>
					</button>
				</div>

				<!-- Hottest/Coldest Locations -->
				<div v-if="outputPanelState === 2">
					<div class="no-results" v-if="error || (hottestLocations.length === 0 && coldestLocations.length === 0)">
						<i class="fa-2x fa-solid fa-file-circle-exclamation"></i>
						No locations found for {{ inHCLDate }}, please try another date.
					</div>

					<div v-if="hottestLocations.length !== 0">
						<div class="header">
							<i class="fa-solid fa-fire"></i>
							Hottest Locations on {{ inHCLDate }}
						</div>
						<table>
							<thead>
								<tr>
									<td>Rank</td>
									<td>Country</td>
									<td>Location ID</td>
									<td>Temp (°F)</td>
								</tr>
							</thead>
							<tbody>
								<tr class="nearby-station" v-for="(row, index) in hottestLocations" @click="goToStation(row[3], row[4])">
									<td>{{ index + 1 }}</td>
									<td>{{ row[0] }}</td>
									<td>{{ row[1] }}</td>
									<td>{{ row[2] }}</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="coldest" v-if="coldestLocations.length !== 0">
						<div class="header">
							<i class="fa-solid fa-snowflake"></i>
							Coldest Locations on {{ inHCLDate }}
						</div>
						<table>
							<thead>
								<tr>
									<td>Rank</td>
									<td>Country</td>
									<td>Location ID</td>
									<td>Temp (°F)</td>
								</tr>
							</thead>
							<tbody>
								<tr class="nearby-station" v-for="(row, index) in coldestLocations" @click="goToStation(row[3], row[4])">
									<td>{{ index + 1 }}</td>
									<td>{{ row[0] }}</td>
									<td>{{ row[1] }}</td>
									<td>{{ row[2] }}</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
		<script type="module" src="static/main.js"></script>
	</body>
</html>
